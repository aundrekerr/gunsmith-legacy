{"ast":null,"code":"import _slicedToArray from \"/Users/aundrekerr/Projects/React2019/gunsmith3/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nexport const statWhiteList = [3614673599, // Blast Radius\n2523465841, // Velocity\n4043523819, // Impact\n1240592695, // Range\n1591432999, // Accuracy\n155624089, // Stability\n943549884, // Handling\n4188031367, // Reload Speed\n2837207746, // Swing Speed (sword)\n2762071195, // Efficiency (sword)\n209426660, // Defense (sword)\n1345609583, // Aim Assistance\n3555269338, // Zoom\n2715839340, // Recoil Direction\n4284893193, // Rounds Per Minute\n2961396640, // Charge Time\n447667954, // Draw Time\n3871231066, // Magazine\n1931675084, // Inventory Size\n925767036];\nexport const statsMs = [447667954, // Draw Time\n2961396640 // Charge Time\n];\nconst hiddenStatsWhitelist = [1345609583, // Aim Assistance\n3555269338, // Zoom\n2715839340 // Recoil Direction\n];\nexport function getMasterworks(theManifest, weaponHash) {\n  let manifest = theManifest;\n  const itemDef = manifest.DestinyInventoryItemDefinition[weaponHash];\n  const masterworkItems = manifest.DestinyPlugSetDefinition[1117738936].reusablePlugItems;\n  const statGroup = manifest.DestinyStatGroupDefinition[itemDef.stats.statGroupHash];\n  const statDisplays = statGroup.scaledStats;\n  const socketIndexes = itemDef.sockets.socketCategories.filter(c => c.socketCategoryHash === 2685412949); // Place this here so it resets.\n\n  let mwCollection = {\n    stability: {\n      benefits: [],\n      hash: 155624089,\n      active: false\n    },\n    range: {\n      benefits: [],\n      hash: 1240592695,\n      active: false\n    },\n    handling: {\n      benefits: [],\n      hash: 943549884,\n      active: false\n    },\n    damage: {\n      benefits: [],\n      hash: 4043523819,\n      active: false\n    },\n    // Impact\n    reload: {\n      benefits: [],\n      hash: 4188031367,\n      active: false\n    },\n    blast_radius: {\n      benefits: [],\n      hash: 3614673599,\n      active: false\n    },\n    projectile_speed: {\n      benefits: [],\n      hash: 2523465841,\n      active: false\n    },\n    // Velocity\n    charge_time: {\n      benefits: [],\n      hash: 2961396640,\n      active: false\n    },\n    draw_time: {\n      benefits: [],\n      hash: 447667954,\n      active: false\n    },\n    accuracy: {\n      benefits: [],\n      hash: 1591432999,\n      active: false\n    }\n  }; // Map through the MW benefits.\n\n  masterworkItems.map(mw => {\n    const mwDef = manifest.DestinyInventoryItemDefinition[mw.plugItemHash];\n    const mwStatSplit = mwDef.plug.plugCategoryIdentifier.split('.');\n    const mwStatName = mwStatSplit[mwStatSplit.length - 1];\n    mwCollection[mwStatName].benefits.push(mwDef);\n  });\n\n  for (const _ref of Object.entries(mwCollection)) {\n    var _ref2 = _slicedToArray(_ref, 2);\n\n    const statType = _ref2[0];\n    const data = _ref2[1];\n\n    if (shouldShowStat(itemDef, data.hash, statDisplays)) {\n      // Don't include Impact if it's not a fusion rifle.\n      if (itemDef.itemSubType !== 11 && statType === 'damage') {\n        mwCollection[statType].active = false;\n        continue;\n      }\n\n      mwCollection[statType].active = true;\n    } else {\n      mwCollection[statType].active = false;\n    }\n  }\n\n  return mwCollection;\n}\n\nfunction oldGetMasterworks(theManifest, weaponHash) {\n  // console.log('----- Building masterworks. -----');\n  let manifest = theManifest;\n  const itemDef = manifest.DestinyInventoryItemDefinition[weaponHash];\n  const sockets = itemDef.sockets;\n  const socketEntries = itemDef.sockets.socketEntries; // Place this here so it resets.\n\n  let mwCollection = {\n    stability: {\n      benefits: [],\n      hash: 155624089,\n      active: false\n    },\n    range: {\n      benefits: [],\n      hash: 1240592695,\n      active: false\n    },\n    handling: {\n      benefits: [],\n      hash: 943549884,\n      active: false\n    },\n    damage: {\n      // Impact\n      benefits: [],\n      hash: 4043523819,\n      active: false\n    },\n    reload: {\n      benefits: [],\n      hash: 4188031367,\n      active: false\n    },\n    blast_radius: {\n      benefits: [],\n      hash: 3614673599,\n      active: false\n    },\n    projectile_speed: {\n      // Velocity\n      benefits: [],\n      hash: 2523465841,\n      active: false\n    },\n    charge_time: {\n      benefits: [],\n      hash: 2961396640,\n      active: false\n    },\n    draw_time: {\n      benefits: [],\n      hash: 447667954,\n      active: false\n    },\n    accuracy: {\n      benefits: [],\n      hash: 1591432999,\n      active: false\n    }\n  };\n\n  if (!itemDef.sockets || !itemDef.sockets.socketEntries) {\n    return null;\n  }\n\n  if (!socketEntries) {\n    return null;\n  }\n\n  const statGroup = manifest.DestinyStatGroupDefinition[itemDef.stats.statGroupHash];\n  const statDisplays = statGroup.scaledStats;\n\n  if (!statGroup) {\n    return null;\n  }\n\n  if (!socketEntries.every(noRandomPerks)) {\n    // Map through slots to find ones that are genuine perks.\n    socketEntries.map(socket => {\n      // console.log(manifest.DestinyInventoryItemDefinition[socket.plugItemHash].itemCategoryHashes)\n      // console.log(socket)\n      // console.log(socket.socketCategories.filter(c => c.socketCategoryHash === 2685412949))\n      if (socket.plugSources === 3 // not perks\n      && socket.preventInitializationOnVendorPurchase === true // something only MWs had???\n      && socket.socketTypeHash !== 1288200359 // not default shader\n      ) {\n          // Map through MW levels\n          socket.reusablePlugItems.map(mw => {\n            const mwDef = manifest.DestinyInventoryItemDefinition[mw.plugItemHash];\n            const mwStatSplit = mwDef.plug.plugCategoryIdentifier.split('.');\n            const mwStatName = mwStatSplit[mwStatSplit.length - 1];\n            mwCollection[mwStatName].benefits.push(mwDef);\n            return true;\n          });\n        }\n\n      return true;\n    });\n  } // Filter out Masterworks that don't apply to this weapon.\n\n\n  for (const _ref3 of Object.entries(mwCollection)) {\n    var _ref4 = _slicedToArray(_ref3, 2);\n\n    const statType = _ref4[0];\n    const data = _ref4[1];\n\n    if (shouldShowStat(itemDef, data.hash, statDisplays)) {\n      // Don't include Impact if it's not a fusion rifle.\n      if (itemDef.itemSubType !== 11 && statType === 'damage') {\n        mwCollection[statType].active = false;\n        continue;\n      }\n\n      mwCollection[statType].active = true;\n    } else {\n      mwCollection[statType].active = false;\n    }\n  }\n\n  return mwCollection;\n}\n\nfunction noRandomPerks(socket) {\n  return socket.hasOwnProperty('randomizedPlugSetHash');\n}\n\nfunction shouldShowStat(itemDef, statHash, statDisplays) {\n  if (statHash === 2961396640 && itemDef.itemCategoryHashes && itemDef.itemCategoryHashes.includes(3317538576)) {\n    return false;\n  }\n\n  return (// Must be on the whitelist\n    statWhiteList.includes(statHash) && ( // Must be on the list of interpolated stats, or included in the hardcoded hidden stats list\n    statDisplays.filter(s => statHash === s.statHash)[0] || hiddenStatsWhitelist.includes(statHash))\n  );\n}","map":{"version":3,"sources":["/Users/aundrekerr/Projects/React2019/gunsmith3/src/utils/masterworks.js"],"names":["statWhiteList","statsMs","hiddenStatsWhitelist","getMasterworks","theManifest","weaponHash","manifest","itemDef","DestinyInventoryItemDefinition","masterworkItems","DestinyPlugSetDefinition","reusablePlugItems","statGroup","DestinyStatGroupDefinition","stats","statGroupHash","statDisplays","scaledStats","socketIndexes","sockets","socketCategories","filter","c","socketCategoryHash","mwCollection","stability","benefits","hash","active","range","handling","damage","reload","blast_radius","projectile_speed","charge_time","draw_time","accuracy","map","mw","mwDef","plugItemHash","mwStatSplit","plug","plugCategoryIdentifier","split","mwStatName","length","push","Object","entries","statType","data","shouldShowStat","itemSubType","oldGetMasterworks","socketEntries","every","noRandomPerks","socket","plugSources","preventInitializationOnVendorPurchase","socketTypeHash","hasOwnProperty","statHash","itemCategoryHashes","includes","s"],"mappings":"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","sourcesContent":["export const statWhiteList = [\n\t3614673599, // Blast Radius\n\t2523465841, // Velocity\n\n\t4043523819, // Impact\n\t1240592695, // Range\n\t1591432999, // Accuracy\n\t155624089, // Stability\n\t943549884, // Handling\n\t4188031367, // Reload Speed\n\n\t2837207746, // Swing Speed (sword)\n\t2762071195, // Efficiency (sword)\n\t209426660, // Defense (sword)\n\t\n\t1345609583, // Aim Assistance\n\t3555269338, // Zoom\n\t2715839340, // Recoil Direction\n\n\t4284893193, // Rounds Per Minute\n\t2961396640, // Charge Time\n\t447667954, // Draw Time\n\n\t3871231066, // Magazine\n\t1931675084, // Inventory Size\n\t925767036, // Ammo Capacity\n];\n\nexport const statsMs = [\n\t447667954, // Draw Time\n\t2961396640 // Charge Time\n];\n\nconst hiddenStatsWhitelist = [\n\t1345609583, // Aim Assistance\n\t3555269338, // Zoom\n\t2715839340 // Recoil Direction\n];\n\n\nexport function getMasterworks(\n\ttheManifest,\n\tweaponHash\n) {\n\tlet manifest = theManifest;\n\tconst itemDef = manifest.DestinyInventoryItemDefinition[weaponHash];\n\tconst masterworkItems = manifest.DestinyPlugSetDefinition[1117738936].reusablePlugItems;\n\tconst statGroup = manifest.DestinyStatGroupDefinition[itemDef.stats.statGroupHash];\n\tconst statDisplays = statGroup.scaledStats;\n\n\tconst socketIndexes = itemDef.sockets.socketCategories.filter(c => c.socketCategoryHash === 2685412949);\n\n\t// Place this here so it resets.\n\tlet mwCollection = {\n\t\tstability: { benefits: [], hash: 155624089, active: false, },\n\t\trange: { benefits: [], hash: 1240592695, active: false, },\n\t\thandling: { benefits: [], hash: 943549884, active: false, },\n\t\tdamage: { benefits: [],  hash: 4043523819, active: false, }, // Impact\n\t\treload: { benefits: [], hash: 4188031367, active: false, },\n\t\tblast_radius: { benefits: [], hash: 3614673599, active: false, },\n\t\tprojectile_speed: { benefits: [],  hash: 2523465841, active: false, }, // Velocity\n\t\tcharge_time: { benefits: [], hash: 2961396640, active: false, },\n\t\tdraw_time: { benefits: [], hash: 447667954, active: false, },\n\t\taccuracy: { benefits: [], hash: 1591432999, active: false, },\n\t};\n\n\t// Map through the MW benefits.\n\tmasterworkItems.map(mw => {\n\t\tconst mwDef = manifest.DestinyInventoryItemDefinition[mw.plugItemHash];\n\t\tconst mwStatSplit = mwDef.plug.plugCategoryIdentifier.split('.');\n\t\tconst mwStatName = mwStatSplit[mwStatSplit.length - 1];\n\t\t\n\t\tmwCollection[mwStatName].benefits.push(mwDef);\n\t});\n\n\tfor (const [statType, data] of Object.entries(mwCollection)) {\n\t\tif (shouldShowStat(itemDef, data.hash, statDisplays)) {\n\n\t\t\t// Don't include Impact if it's not a fusion rifle.\n\t\t\tif ( itemDef.itemSubType !== 11 && statType === 'damage'  ) {\n\t\t\t\tmwCollection[statType].active = false;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t\n\t\t\tmwCollection[statType].active = true;\n\t\t} else {\n\t\t\tmwCollection[statType].active = false;\n\t\t}\n\t}\n\n\treturn mwCollection;\n}\n\n\n\nfunction oldGetMasterworks(\n\ttheManifest,\n\tweaponHash\n) {\n\t// console.log('----- Building masterworks. -----');\n\tlet manifest = theManifest;\n\tconst itemDef = manifest.DestinyInventoryItemDefinition[weaponHash];\n\tconst sockets = itemDef.sockets;\n\tconst socketEntries = itemDef.sockets.socketEntries;\n\n\t// Place this here so it resets.\n\tlet mwCollection = {\n\t\tstability: { \n\t\t\tbenefits: [], hash: 155624089, active: false,\n\t\t},\n\t\trange: { \n\t\t\tbenefits: [], hash: 1240592695, active: false,\n\t\t},\n\t\thandling: { \n\t\t\tbenefits: [], hash: 943549884, active: false,\n\t\t},\n\t\tdamage: { // Impact\n\t\t\tbenefits: [],  hash: 4043523819, active: false,\n\t\t},\n\t\treload: { \n\t\t\tbenefits: [], hash: 4188031367, active: false,\n\t\t},\n\t\tblast_radius: { \n\t\t\tbenefits: [], hash: 3614673599, active: false,\n\t\t},\n\t\tprojectile_speed: { // Velocity\n\t\t\tbenefits: [],  hash: 2523465841, active: false,\n\t\t},\n\t\tcharge_time: { \n\t\t\tbenefits: [], hash: 2961396640, active: false,\n\t\t},\n\t\tdraw_time: { \n\t\t\tbenefits: [], hash: 447667954, active: false,\n\t\t},\n\t\taccuracy: { \n\t\t\tbenefits: [], hash: 1591432999, active: false,\n\t\t},\n\t};\n\n\tif (!itemDef.sockets || !itemDef.sockets.socketEntries) {\n\t\treturn null;\n\t}\n\n\tif (!socketEntries) {\n\t\treturn null;\n\t}\n\n\tconst statGroup = manifest.DestinyStatGroupDefinition[itemDef.stats.statGroupHash];\n\tconst statDisplays = statGroup.scaledStats;\n\tif (!statGroup) {\n\t\treturn null;\n\t}\n\n\t\n\n\tif ( !socketEntries.every(noRandomPerks) ) {\n\t\t// Map through slots to find ones that are genuine perks.\n\t\tsocketEntries.map(socket => {\n\n\t\t\t// console.log(manifest.DestinyInventoryItemDefinition[socket.plugItemHash].itemCategoryHashes)\n\t\t\t// console.log(socket)\n\t\t\t// console.log(socket.socketCategories.filter(c => c.socketCategoryHash === 2685412949))\n\n\t\t\tif (socket.plugSources === 3 // not perks\n\t\t\t\t&& socket.preventInitializationOnVendorPurchase === true // something only MWs had???\n\t\t\t\t&& socket.socketTypeHash !== 1288200359 // not default shader\n\t\t\t) {\n\t\t\t\t// Map through MW levels\n\t\t\t\tsocket.reusablePlugItems.map(mw => {\n\t\t\t\t\tconst mwDef = manifest.DestinyInventoryItemDefinition[mw.plugItemHash];\n\t\t\t\t\tconst mwStatSplit = mwDef.plug.plugCategoryIdentifier.split('.');\n\t\t\t\t\tconst mwStatName = mwStatSplit[mwStatSplit.length - 1];\n\t\t\t\t\t\n\t\t\t\t\tmwCollection[mwStatName].benefits.push(mwDef);\n\t\t\t\t\treturn true;\n\t\t\t\t})\n\t\t\t}\n\n\t\t\treturn true;\n\t\t})\n\t}\n\n\t// Filter out Masterworks that don't apply to this weapon.\n\tfor (const [statType, data] of Object.entries(mwCollection)) {\n\t\tif (shouldShowStat(itemDef, data.hash, statDisplays)) {\n\n\t\t\t// Don't include Impact if it's not a fusion rifle.\n\t\t\tif ( itemDef.itemSubType !== 11 && statType === 'damage'  ) {\n\t\t\t\tmwCollection[statType].active = false;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t\n\t\t\tmwCollection[statType].active = true;\n\t\t} else {\n\t\t\tmwCollection[statType].active = false;\n\t\t}\n\t}\n\n\treturn mwCollection;\n}\n\nfunction noRandomPerks (\n\tsocket\n) {\n\treturn socket.hasOwnProperty('randomizedPlugSetHash')\n}\n\nfunction shouldShowStat (\n\titemDef, \n\tstatHash, \n\tstatDisplays\n) {\n\tif (\n\t\tstatHash === 2961396640 &&\n\t\titemDef.itemCategoryHashes &&\n\t\titemDef.itemCategoryHashes.includes(3317538576)\n\t) {\n\t\treturn false;\n\t}\n\n\treturn (\n\t\t// Must be on the whitelist\n\t\tstatWhiteList.includes(statHash) &&\n\t\t// Must be on the list of interpolated stats, or included in the hardcoded hidden stats list\n\t\t(statDisplays.filter(s => statHash === s.statHash)[0] || hiddenStatsWhitelist.includes(statHash))\n\t);\n}"]},"metadata":{},"sourceType":"module"}