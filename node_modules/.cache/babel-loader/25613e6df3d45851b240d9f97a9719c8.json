{"ast":null,"code":"var _jsxFileName = \"/Users/aundrekerr/Documents/GitHub/gunsmith/src/components/Search/index.js\";\nimport React, { Component } from 'react';\nimport ReactDOM from 'react-dom';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport SearchInput from './SearchInput';\nimport Filters from './Filters';\nimport Suggestions from './Suggestions';\nimport { storeWeapon, storePerks, storeMod, storeMasterwork } from './../../actions/weaponActions';\nimport { storeCollection, storeRarity, storeWeaponType, storeDamage } from './../../actions/filterActions';\nimport collections from './../../utils/custom-data/weaponSets.js';\n\nclass Search extends Component {\n  constructor(props) {\n    super(props);\n\n    this.updateSuggestions = (input, from = {}) => {\n      const {\n        weaponList\n      } = this.state;\n      let {\n        collection,\n        rarity,\n        weaponType,\n        damage\n      } = this.props.filters;\n      let {\n        userInput\n      } = this.state; // If the input field sends over data, make that the new input data to filter with.\n\n      userInput = input; // If a select field sends over a new filter, update the settings here.\n\n      if (from.hasOwnProperty('collection')) collection = from.collection;\n      if (from.hasOwnProperty('rarity')) rarity = from.rarity;\n      if (from.hasOwnProperty('weaponType')) weaponType = from.weaponType;\n      if (from.hasOwnProperty('damage')) damage = from.damage; // Set the current collection object.\n\n      let currentCollection = collections.filter(col => col.name === collection)[0];\n      if (!currentCollection) currentCollection = {\n        name: 'Any',\n        weapons: []\n      }; // Filter through the full weapons list based on the select field filters.\n\n      let filteredList = weaponList;\n      if (currentCollection.weapons.length > 0) filteredList = filteredList.filter(weapon => currentCollection.weapons.includes(weapon.hash));\n      if (rarity) filteredList = filteredList.filter(weapon => {\n        return weapon.inventory.tierTypeHash === rarity;\n      });\n      if (weaponType) filteredList = filteredList.filter(weapon => {\n        return weapon.itemSubType === weaponType;\n      });\n      if (damage) filteredList = filteredList.filter(weapon => {\n        return weapon.defaultDamageTypeHash === damage;\n      }); // Filter through what's left based on the input field.\n\n      let suggestions = filteredList.filter(suggestion => suggestion.displayProperties.name.toLowerCase().indexOf(userInput.toLowerCase()) > -1);\n      suggestions = suggestions.sort((a, b) => a.displayProperties.name.toLowerCase().localeCompare(b.displayProperties.name.toLowerCase())); // Set the new list and give the OK to display the suggestions.\n\n      this.setState({\n        filteredSuggestions: suggestions,\n        showSuggestions: true\n      });\n    };\n\n    this.onInputChange = e => {\n      this.setState({\n        userInput: e.currentTarget.value\n      });\n      this.updateSuggestions(e.currentTarget.value);\n    };\n\n    this.changeCollection = e => {\n      let toStore = e.target.value;\n      this.setState({\n        currentCollection: toStore\n      });\n      this.props.storeCollection(toStore);\n      this.updateSuggestions(this.state.userInput, {\n        collection: toStore\n      });\n    };\n\n    this.changeRarity = e => {\n      let toStore = e.target.value === 0 ? null : parseInt(e.target.value);\n      this.setState({\n        currentRarity: toStore\n      });\n      this.props.storeRarity(toStore);\n      this.updateSuggestions(this.state.userInput, {\n        rarity: toStore\n      });\n    };\n\n    this.changeWeaponType = e => {\n      let toStore = e.target.value === 0 ? null : parseInt(e.target.value);\n      this.setState({\n        currentWeaponType: toStore\n      });\n      this.props.storeWeaponType(toStore);\n      this.updateSuggestions(this.state.userInput, {\n        weaponType: toStore\n      });\n    };\n\n    this.changeDamage = e => {\n      let toStore = e.target.value === 0 ? null : parseInt(e.target.value);\n      this.setState({\n        currentDamage: toStore\n      });\n      this.props.storeDamage(toStore);\n      this.updateSuggestions(this.state.userInput, {\n        damage: toStore\n      });\n    };\n\n    this.onSuggestionClick = hash => {\n      // console.log(hash)\n      this.props.storeWeapon(hash);\n      this.props.storePerks({\n        hash: 0\n      }, 1);\n      this.props.storePerks({\n        hash: 0\n      }, 2);\n      this.props.storePerks({\n        hash: 0\n      }, 3);\n      this.props.storePerks({\n        hash: 0\n      }, 4);\n      this.props.storeMod({\n        hash: 0\n      });\n      this.props.storeMasterwork({\n        hash: 0\n      });\n\n      if (window.innerWidth < 992) {\n        this.setState({\n          activeSuggestion: 0,\n          // filteredSuggestions: [],\n          // showSuggestions: false,\n          userInput: ''\n        });\n      }\n\n      this.props.toggleMenu();\n    };\n\n    this.getRefData = () => {\n      let input = this.inputElem;\n      let filters = this.filtersElem;\n      const inputDomNode = ReactDOM.findDOMNode(input);\n      const filtersDomNode = ReactDOM.findDOMNode(filters);\n      input = inputDomNode.getBoundingClientRect();\n      filters = filtersDomNode.getBoundingClientRect();\n      return {\n        filters,\n        input\n      };\n    };\n\n    this.state = {\n      weaponList: [],\n      filteredSuggestions: [],\n      showSuggestions: false,\n      userInput: '',\n      currentRarity: null,\n      currentWeaponType: 0,\n      currentDamage: 0\n    };\n  }\n\n  componentDidMount() {\n    const {\n      manifest\n    } = this.props;\n    const {\n      currentRarity\n    } = this.state;\n    let fullList = []; // All Weapons\n\n    Object.keys(manifest.DestinyInventoryItemDefinition).map(weapon => {\n      return manifest.DestinyInventoryItemDefinition[weapon].itemType === 3 ? fullList.push(manifest.DestinyInventoryItemDefinition[weapon]) : null;\n    });\n    let filteredList = fullList.filter(weapon => {\n      return weapon.inventory.tierTypeHash === currentRarity;\n    });\n    this.setState({\n      filteredSuggestions: filteredList,\n      weaponList: fullList\n    });\n  }\n\n  render() {\n    const {\n      onInputChange,\n      changeCollection,\n      changeRarity,\n      changeWeaponType,\n      changeDamage,\n      onSuggestionClick,\n      state: {\n        weaponList,\n        filteredSuggestions,\n        showSuggestions,\n        userInput,\n        currentRarity,\n        currentWeaponType,\n        currentDamage\n      },\n      props: {\n        manifestLoaded,\n        menuView\n      }\n    } = this;\n    return React.createElement(\"div\", {\n      className: `search__wrapper ${menuView}`,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182\n      },\n      __self: this\n    }, React.createElement(SearchInput, {\n      onInputChange: onInputChange,\n      userInput: userInput,\n      manifestLoaded: manifestLoaded,\n      inputRef: el => this.inputElem = el,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183\n      },\n      __self: this\n    }), React.createElement(Filters, {\n      changeCollection: changeCollection,\n      changeRarity: changeRarity,\n      changeWeaponType: changeWeaponType,\n      changeDamage: changeDamage,\n      currentRarity: currentRarity,\n      currentWeaponType: currentWeaponType,\n      currentDamage: currentDamage,\n      filtersRef: el => this.filtersElem = el,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189\n      },\n      __self: this\n    }), React.createElement(Suggestions, {\n      weaponList: weaponList,\n      filteredSuggestions: filteredSuggestions,\n      showSuggestions: showSuggestions,\n      userInput: userInput,\n      onSuggestionClick: onSuggestionClick,\n      getRefData: () => this.getRefData(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199\n      },\n      __self: this\n    }));\n  }\n\n}\n\nSearch.propTypes = {\n  storeWeapon: PropTypes.func.isRequired,\n  storeCollection: PropTypes.func.isRequired,\n  storeRarity: PropTypes.func.isRequired,\n  storeWeaponType: PropTypes.func.isRequired,\n  storeDamage: PropTypes.func.isRequired\n};\n\nconst mapStateToProps = state => ({\n  manifest: state.manifest,\n  manifestLoaded: state.manifestLoaded,\n  filters: state.filters,\n  weapon: state.weapon\n});\n\nexport default connect(mapStateToProps, {\n  storeWeapon,\n  storePerks,\n  storeMod,\n  storeMasterwork,\n  storeCollection,\n  storeRarity,\n  storeWeaponType,\n  storeDamage\n})(Search);","map":{"version":3,"sources":["/Users/aundrekerr/Documents/GitHub/gunsmith/src/components/Search/index.js"],"names":["React","Component","ReactDOM","PropTypes","connect","SearchInput","Filters","Suggestions","storeWeapon","storePerks","storeMod","storeMasterwork","storeCollection","storeRarity","storeWeaponType","storeDamage","collections","Search","constructor","props","updateSuggestions","input","from","weaponList","state","collection","rarity","weaponType","damage","filters","userInput","hasOwnProperty","currentCollection","filter","col","name","weapons","filteredList","length","weapon","includes","hash","inventory","tierTypeHash","itemSubType","defaultDamageTypeHash","suggestions","suggestion","displayProperties","toLowerCase","indexOf","sort","a","b","localeCompare","setState","filteredSuggestions","showSuggestions","onInputChange","e","currentTarget","value","changeCollection","toStore","target","changeRarity","parseInt","currentRarity","changeWeaponType","currentWeaponType","changeDamage","currentDamage","onSuggestionClick","window","innerWidth","activeSuggestion","toggleMenu","getRefData","inputElem","filtersElem","inputDomNode","findDOMNode","filtersDomNode","getBoundingClientRect","componentDidMount","manifest","fullList","Object","keys","DestinyInventoryItemDefinition","map","itemType","push","render","manifestLoaded","menuView","el","propTypes","func","isRequired","mapStateToProps"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport ReactDOM from 'react-dom';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport SearchInput from './SearchInput';\nimport Filters from './Filters';\nimport Suggestions from './Suggestions';\nimport { storeWeapon, storePerks, storeMod, storeMasterwork } from './../../actions/weaponActions';\nimport { storeCollection, storeRarity, storeWeaponType, storeDamage } from './../../actions/filterActions';\nimport collections from './../../utils/custom-data/weaponSets.js';\n\nclass Search extends Component {\n\tconstructor(props) {\n\t\tsuper(props)\n\n\t\tthis.state = {\n\t\t\tweaponList: [],\n\t\t\tfilteredSuggestions: [],\n\t\t\tshowSuggestions: false,\n\t\t\tuserInput: '',\n\t\t\tcurrentRarity: null,\n\t\t\tcurrentWeaponType: 0,\n\t\t\tcurrentDamage: 0,\n\t\t}\n\t}\n\n\tcomponentDidMount() {\n\t\tconst { manifest } = this.props;\n\t\tconst { currentRarity } = this.state;\n\t\t\n\t\tlet fullList = [];\n\t\t\n\t\t// All Weapons\n\t\tObject.keys(manifest.DestinyInventoryItemDefinition).map(weapon => {\n\t\t\treturn manifest.DestinyInventoryItemDefinition[weapon].itemType === 3\n\t\t\t\t? fullList.push(manifest.DestinyInventoryItemDefinition[weapon])\n\t\t\t\t: null\n\t\t})\n\n\t\tlet filteredList = fullList.filter(weapon => { \n\t\t\treturn weapon.inventory.tierTypeHash === currentRarity\n\t\t})\n\n\t\tthis.setState({ \n\t\t\tfilteredSuggestions: filteredList,\n\t\t\tweaponList: fullList\n\t\t})\n\t}\n\n\tupdateSuggestions = (input, from = {}) => {\n\t\tconst { weaponList } = this.state;\n\t\tlet { collection, rarity, weaponType, damage } = this.props.filters;\n\t\tlet { userInput } = this.state;\n\n\t\t// If the input field sends over data, make that the new input data to filter with.\n\t\tuserInput = input;\t\n\t\t\n\t\t// If a select field sends over a new filter, update the settings here.\n\t\tif ( from.hasOwnProperty('collection') ) collection = from.collection;\n\t\tif ( from.hasOwnProperty('rarity') ) rarity = from.rarity;\n\t\tif ( from.hasOwnProperty('weaponType') ) weaponType = from.weaponType;\n\t\tif ( from.hasOwnProperty('damage') ) damage = from.damage;\n\n\t\t// Set the current collection object.\n\t\tlet currentCollection = collections.filter(col => col.name === collection )[0];\n\t\tif ( !currentCollection ) currentCollection = { name: 'Any', weapons: [] }\n\n\t\t// Filter through the full weapons list based on the select field filters.\n\t\tlet filteredList = weaponList;\n\t\tif (currentCollection.weapons.length > 0) filteredList = filteredList.filter(weapon => currentCollection.weapons.includes(weapon.hash));\n\t\tif (rarity) filteredList = filteredList.filter(weapon => { return weapon.inventory.tierTypeHash === rarity });\n\t\tif (weaponType) filteredList = filteredList.filter(weapon => { return weapon.itemSubType === weaponType });\n\t\tif (damage) filteredList = filteredList.filter(weapon => { return weapon.defaultDamageTypeHash === damage });\n\n\t\t// Filter through what's left based on the input field.\n\t\tlet suggestions = filteredList.filter( suggestion => (suggestion.displayProperties.name).toLowerCase().indexOf(userInput.toLowerCase()) > -1 );\n\n\t\tsuggestions = suggestions.sort((a, b) => a.displayProperties.name.toLowerCase().localeCompare(b.displayProperties.name.toLowerCase()) )\n\t\t// Set the new list and give the OK to display the suggestions.\n\t\tthis.setState({\n\t\t\tfilteredSuggestions: suggestions,\n\t\t\tshowSuggestions: true,\n\t\t})\n\t}\n\n\t// SearchInput.js\n\tonInputChange = e => {\n\t\tthis.setState({\n\t\t\tuserInput: e.currentTarget.value\n\t\t})\n\n\t\tthis.updateSuggestions(e.currentTarget.value);\n\t}\n\n\t// Filters.js\n\tchangeCollection = (e) => {\n\t\tlet toStore = e.target.value;\n\t\tthis.setState({ currentCollection: toStore }); \n\t\tthis.props.storeCollection(toStore);\n\t\tthis.updateSuggestions(this.state.userInput, { collection: toStore });\n\t}\n\tchangeRarity = (e) => {\n\t\tlet toStore = e.target.value === 0 ? null : parseInt(e.target.value);\n\t\tthis.setState({ currentRarity: toStore }); \n\t\tthis.props.storeRarity(toStore);\n\t\tthis.updateSuggestions(this.state.userInput, { rarity: toStore });\n\t}\n\tchangeWeaponType = (e) => {\n\t\tlet toStore = e.target.value === 0 ? null : parseInt(e.target.value);\n\t\tthis.setState({ currentWeaponType: toStore }); \n\t\tthis.props.storeWeaponType(toStore);\n\t\tthis.updateSuggestions(this.state.userInput, { weaponType: toStore });\n\t}\n\tchangeDamage = (e) => {\n\t\tlet toStore = e.target.value === 0 ? null : parseInt(e.target.value);\n\t\tthis.setState({ currentDamage: toStore }); \n\t\tthis.props.storeDamage(toStore);\n\t\tthis.updateSuggestions(this.state.userInput, { damage: toStore });\n\t}\n\n\n\t\n\t\n\tonSuggestionClick = (hash) => {\n\t\t// console.log(hash)\n\t\tthis.props.storeWeapon(hash);\t\n\t\tthis.props.storePerks({ hash: 0 }, 1);\n\t\tthis.props.storePerks({ hash: 0 }, 2);\n\t\tthis.props.storePerks({ hash: 0 }, 3);\n\t\tthis.props.storePerks({ hash: 0 }, 4);\n\t\tthis.props.storeMod({ hash: 0 });\n\t\tthis.props.storeMasterwork({ hash: 0 });\n\n\t\tif ( window.innerWidth < 992) {\n\t\t\tthis.setState({\n\t\t\t\tactiveSuggestion: 0,\n\t\t\t\t// filteredSuggestions: [],\n\t\t\t\t// showSuggestions: false,\n\t\t\t\tuserInput: ''\n\t\t\t})\n\t\t}\n\n\t\tthis.props.toggleMenu();\n\t}\n\n\tgetRefData = () => {\n\t\tlet input = this.inputElem;\n\t\tlet filters = this.filtersElem;\n\t\tconst inputDomNode = ReactDOM.findDOMNode(input);\n\t\tconst filtersDomNode = ReactDOM.findDOMNode(filters);\n\t\tinput = inputDomNode.getBoundingClientRect();\n\t\tfilters = filtersDomNode.getBoundingClientRect();\n\n\t\treturn { filters, input };\n\t}\n\n\trender() {\n\t\tconst {\n\t\t\tonInputChange,\n\t\t\tchangeCollection,\n\t\t\tchangeRarity,\n\t\t\tchangeWeaponType,\n\t\t\tchangeDamage,\n\t\t\tonSuggestionClick,\n\t\t\t\n\t\t\tstate: {\n\t\t\t\tweaponList,\n\t\t\t\tfilteredSuggestions,\n\t\t\t\tshowSuggestions,\n\t\t\t\tuserInput,\n\t\t\t\tcurrentRarity,\n\t\t\t\tcurrentWeaponType,\n\t\t\t\tcurrentDamage,\n\t\t\t},\n\t\t\tprops: {\n\t\t\t\tmanifestLoaded,\n\t\t\t\tmenuView\n\t\t\t}\n\t\t} = this;\n\t\t\n\t\treturn (\n\t\t\t<div className={`search__wrapper ${menuView}`}>\n\t\t\t\t<SearchInput \n\t\t\t\t\tonInputChange={ onInputChange }\n\t\t\t\t\tuserInput={ userInput }\n\t\t\t\t\tmanifestLoaded={ manifestLoaded }\n\t\t\t\t\tinputRef={el => this.inputElem = el}\n\t\t\t\t/>\n\t\t\t\t<Filters \n\t\t\t\t\tchangeCollection={ changeCollection }\n\t\t\t\t\tchangeRarity={ changeRarity }\n\t\t\t\t\tchangeWeaponType={ changeWeaponType }\n\t\t\t\t\tchangeDamage={ changeDamage }\n\t\t\t\t\tcurrentRarity={ currentRarity }\n\t\t\t\t\tcurrentWeaponType={ currentWeaponType }\n\t\t\t\t\tcurrentDamage={ currentDamage }\n\t\t\t\t\tfiltersRef={el => this.filtersElem = el}\n\t\t\t\t/>\n\t\t\t\t<Suggestions \n\t\t\t\t\tweaponList={ weaponList }\n\t\t\t\t\tfilteredSuggestions={ filteredSuggestions }\n\t\t\t\t\tshowSuggestions={ showSuggestions }\n\t\t\t\t\tuserInput={ userInput }\n\t\t\t\t\tonSuggestionClick={ onSuggestionClick }\n\t\t\t\t\tgetRefData={ () => this.getRefData() }\n\t\t\t\t/>\n\t\t\t</div>\n\t\t)\n\t}\n}\n\nSearch.propTypes = {\n\tstoreWeapon: PropTypes.func.isRequired,\n\tstoreCollection: PropTypes.func.isRequired,\n\tstoreRarity: PropTypes.func.isRequired,\n\tstoreWeaponType: PropTypes.func.isRequired,\n\tstoreDamage: PropTypes.func.isRequired,\n};\n\nconst mapStateToProps = state => ({\n\tmanifest: state.manifest,\n\tmanifestLoaded: state.manifestLoaded,\n\tfilters: state.filters,\n\tweapon: state.weapon,\n});\n\nexport default connect(mapStateToProps, { \n\tstoreWeapon, storePerks, storeMod, storeMasterwork,\n\tstoreCollection, storeRarity, storeWeaponType, storeDamage,\n})(Search);"]},"metadata":{},"sourceType":"module"}