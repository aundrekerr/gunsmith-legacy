{"ast":null,"code":"import _slicedToArray from \"/Users/aundrekerr/Projects/React2019/gunsmith3/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nlet manifest;\nlet mwCollection = {\n  stability: {\n    benefits: [],\n    hash: 155624089\n  },\n  range: {\n    benefits: [],\n    hash: 1240592695\n  },\n  handling: {\n    benefits: [],\n    hash: 943549884\n  },\n  damage: {\n    // Impact\n    benefits: [],\n    hash: 4043523819\n  },\n  reload: {\n    benefits: [],\n    hash: 4188031367\n  },\n  blast_radius: {\n    benefits: [],\n    hash: 3614673599\n  },\n  projectile_speed: {\n    // Velocity\n    benefits: [],\n    hash: 2523465841\n  },\n  charge_time: {\n    benefits: [],\n    hash: 2961396640\n  },\n  draw_time: {\n    benefits: [],\n    hash: 447667954\n  },\n  accuracy: {\n    benefits: [],\n    hash: 1591432999\n  }\n};\nexport const statWhiteList = [3614673599, // Blast Radius\n2523465841, // Velocity\n4043523819, // Impact\n1240592695, // Range\n1591432999, // Accuracy\n155624089, // Stability\n943549884, // Handling\n4188031367, // Reload Speed\n2837207746, // Swing Speed (sword)\n2762071195, // Efficiency (sword)\n209426660, // Defense (sword)\n1345609583, // Aim Assistance\n3555269338, // Zoom\n2715839340, // Recoil Direction\n4284893193, // Rounds Per Minute\n2961396640, // Charge Time\n447667954, // Draw Time\n3871231066, // Magazine\n1931675084, // Inventory Size\n925767036];\nconst statsNoBar = [4284893193, // Rounds Per Minute\n3871231066, // Magazine\n2961396640, // Charge Time\n447667954, // Draw Time\n1931675084, // Recovery\n2715839340 // Recoil Direction\n];\nexport const statsMs = [447667954, // Draw Time\n2961396640 // Charge Time\n];\nconst hiddenStatsWhitelist = [1345609583, // Aim Assistance\n3555269338, // Zoom\n2715839340 // Recoil Direction\n];\nexport function getMasterworks(theManifest, weaponHash) {\n  console.log('----- Building masterworks. -----');\n  let manifest = theManifest;\n  const itemDef = manifest.DestinyInventoryItemDefinition[weaponHash];\n  const socketEntries = itemDef.sockets.socketEntries;\n\n  if (!itemDef.sockets || !itemDef.sockets.socketEntries) {\n    return null;\n  }\n\n  if (!socketEntries) {\n    return null;\n  }\n\n  const statGroup = manifest.DestinyStatGroupDefinition[itemDef.stats.statGroupHash];\n  const statDisplays = statGroup.scaledStats;\n\n  if (!statGroup) {\n    return null;\n  }\n\n  if (!socketEntries.every(noRandomPerks)) {\n    // Map through slots to find ones that are genuine perks.\n    socketEntries.map(socket => {\n      if (socket.plugSources === 3 // not perks\n      && socket.preventInitializationOnVendorPurchase === true // something only MWs had???\n      && socket.socketTypeHash !== 1288200359 // not default shader\n      ) {\n          // Map through MW levels\n          socket.reusablePlugItems.map(mw => {\n            const mwDef = manifest.DestinyInventoryItemDefinition[mw.plugItemHash];\n            const mwStatSplit = mwDef.plug.plugCategoryIdentifier.split('.');\n            const mwStatName = mwStatSplit[mwStatSplit.length - 1];\n            mwCollection[mwStatName].benefits.push(mwDef);\n          });\n        }\n    });\n  } // Filter out Masterworks that don't apply to this weapon.\n\n\n  for (const _ref of Object.entries(mwCollection)) {\n    var _ref2 = _slicedToArray(_ref, 2);\n\n    const statType = _ref2[0];\n    const data = _ref2[1];\n\n    if (shouldShowStat(itemDef, data.hash, statDisplays)) {\n      // Don't include Impact if it's not a fusion rifle.\n      if (itemDef.itemSubType !== 11 && statType === 'damage') {\n        continue;\n      }\n\n      console.log(statType);\n    }\n  }\n\n  console.log(mwCollection);\n}\n\nfunction noRandomPerks(socket) {\n  return socket.randomizedPlugItems.length === 0;\n}\n\nfunction shouldShowStat(itemDef, statHash, statDisplays) {\n  if (statHash === 2961396640 && itemDef.itemCategoryHashes && itemDef.itemCategoryHashes.includes(3317538576)) {\n    return false;\n  }\n\n  return (// Must be on the whitelist\n    statWhiteList.includes(statHash) && ( // Must be on the list of interpolated stats, or included in the hardcoded hidden stats list\n    statDisplays.filter(s => statHash === s.statHash)[0] || hiddenStatsWhitelist.includes(statHash))\n  );\n}","map":{"version":3,"sources":["/Users/aundrekerr/Projects/React2019/gunsmith3/src/utils/masterworks.js"],"names":["manifest","mwCollection","stability","benefits","hash","range","handling","damage","reload","blast_radius","projectile_speed","charge_time","draw_time","accuracy","statWhiteList","statsNoBar","statsMs","hiddenStatsWhitelist","getMasterworks","theManifest","weaponHash","console","log","itemDef","DestinyInventoryItemDefinition","socketEntries","sockets","statGroup","DestinyStatGroupDefinition","stats","statGroupHash","statDisplays","scaledStats","every","noRandomPerks","map","socket","plugSources","preventInitializationOnVendorPurchase","socketTypeHash","reusablePlugItems","mw","mwDef","plugItemHash","mwStatSplit","plug","plugCategoryIdentifier","split","mwStatName","length","push","Object","entries","statType","data","shouldShowStat","itemSubType","randomizedPlugItems","statHash","itemCategoryHashes","includes","filter","s"],"mappings":"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","sourcesContent":["let manifest;\n\nlet mwCollection = {\n\tstability: { \n\t\tbenefits: [],\n\t\thash: 155624089,\n\t},\n\trange: { \n\t\tbenefits: [],\n\t\thash: 1240592695,\n\t},\n\thandling: { \n\t\tbenefits: [],\n\t\thash: 943549884,\n\t},\n\tdamage: { // Impact\n\t\tbenefits: [], \n\t\thash: 4043523819,\n\t},\n\treload: { \n\t\tbenefits: [],\n\t\thash: 4188031367,\n\t},\n\tblast_radius: { \n\t\tbenefits: [],\n\t\thash: 3614673599,\n\t},\n\tprojectile_speed: { // Velocity\n\t\tbenefits: [], \n\t\thash: 2523465841,\n\t},\n\tcharge_time: { \n\t\tbenefits: [],\n\t\thash: 2961396640,\n\t},\n\tdraw_time: { \n\t\tbenefits: [],\n\t\thash: 447667954,\n\t},\n\taccuracy: { \n\t\tbenefits: [],\n\t\thash: 1591432999,\n\t},\n};\n\n\nexport const statWhiteList = [\n\t3614673599, // Blast Radius\n\t2523465841, // Velocity\n\n\t4043523819, // Impact\n\t1240592695, // Range\n\t1591432999, // Accuracy\n\t155624089, // Stability\n\t943549884, // Handling\n\t4188031367, // Reload Speed\n\n\t2837207746, // Swing Speed (sword)\n\t2762071195, // Efficiency (sword)\n\t209426660, // Defense (sword)\n\t\n\t1345609583, // Aim Assistance\n\t3555269338, // Zoom\n\t2715839340, // Recoil Direction\n\n\t4284893193, // Rounds Per Minute\n\t2961396640, // Charge Time\n\t447667954, // Draw Time\n\n\t3871231066, // Magazine\n\t1931675084, // Inventory Size\n\t925767036, // Ammo Capacity\n];\n\nconst statsNoBar = [\n\t4284893193, // Rounds Per Minute\n\t3871231066, // Magazine\n\t2961396640, // Charge Time\n\t447667954, // Draw Time\n\t1931675084, // Recovery\n\t2715839340 // Recoil Direction\n];\n\nexport const statsMs = [\n\t447667954, // Draw Time\n\t2961396640 // Charge Time\n];\n\nconst hiddenStatsWhitelist = [\n\t1345609583, // Aim Assistance\n\t3555269338, // Zoom\n\t2715839340 // Recoil Direction\n];\n\n\n\nexport function getMasterworks(\n\ttheManifest,\n\tweaponHash\n) {\n\tconsole.log('----- Building masterworks. -----');\n\tlet manifest = theManifest;\n\tconst itemDef = manifest.DestinyInventoryItemDefinition[weaponHash];\n\tconst socketEntries = itemDef.sockets.socketEntries;\n\n\tif (!itemDef.sockets || !itemDef.sockets.socketEntries) {\n\t\treturn null;\n\t}\n\n\tif (!socketEntries) {\n\t\treturn null;\n\t}\n\n\tconst statGroup = manifest.DestinyStatGroupDefinition[itemDef.stats.statGroupHash];\n\tconst statDisplays = statGroup.scaledStats;\n\tif (!statGroup) {\n\t\treturn null;\n\t}\n\n\tif ( !socketEntries.every(noRandomPerks) ) {\n\t\t// Map through slots to find ones that are genuine perks.\n\t\tsocketEntries.map(socket => {\n\t\t\tif (socket.plugSources === 3 // not perks\n\t\t\t\t&& socket.preventInitializationOnVendorPurchase === true // something only MWs had???\n\t\t\t\t&& socket.socketTypeHash !== 1288200359 // not default shader\n\t\t\t) {\n\t\t\t\t// Map through MW levels\n\t\t\t\tsocket.reusablePlugItems.map(mw => {\n\t\t\t\t\tconst mwDef = manifest.DestinyInventoryItemDefinition[mw.plugItemHash];\n\t\t\t\t\tconst mwStatSplit = mwDef.plug.plugCategoryIdentifier.split('.');\n\t\t\t\t\tconst mwStatName = mwStatSplit[mwStatSplit.length - 1];\n\t\t\t\t\t\n\t\t\t\t\tmwCollection[mwStatName].benefits.push(mwDef)\n\t\t\t\t})\n\t\t\t}\n\t\t})\n\t}\n\n\t// Filter out Masterworks that don't apply to this weapon.\n\tfor (const [statType, data] of Object.entries(mwCollection)) {\n\t\tif (shouldShowStat(itemDef, data.hash, statDisplays)) {\n\n\t\t\t// Don't include Impact if it's not a fusion rifle.\n\t\t\tif ( itemDef.itemSubType !== 11 && statType === 'damage'  ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconsole.log(statType)\n\t\t}\n\t}\n\n\tconsole.log(mwCollection)\n}\n\nfunction noRandomPerks (\n\tsocket\n) {\n\treturn socket.randomizedPlugItems.length === 0\n}\n\nfunction shouldShowStat (\n\titemDef, \n\tstatHash, \n\tstatDisplays\n) {\n\tif (\n\t\tstatHash === 2961396640 &&\n\t\titemDef.itemCategoryHashes &&\n\t\titemDef.itemCategoryHashes.includes(3317538576)\n\t) {\n\t\treturn false;\n\t}\n\n\treturn (\n\t\t// Must be on the whitelist\n\t\tstatWhiteList.includes(statHash) &&\n\t\t// Must be on the list of interpolated stats, or included in the hardcoded hidden stats list\n\t\t(statDisplays.filter(s => statHash === s.statHash)[0] || hiddenStatsWhitelist.includes(statHash))\n\t);\n}"]},"metadata":{},"sourceType":"module"}