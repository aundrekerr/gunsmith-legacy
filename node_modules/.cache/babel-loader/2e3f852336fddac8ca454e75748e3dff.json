{"ast":null,"code":"import _slicedToArray from \"/Users/aundrekerr/Projects/React2019/gunsmith3/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nexport const statWhiteList = [3614673599, // Blast Radius\n2523465841, // Velocity\n4043523819, // Impact\n1240592695, // Range\n1591432999, // Accuracy\n155624089, // Stability\n943549884, // Handling\n4188031367, // Reload Speed\n2837207746, // Swing Speed (sword)\n2762071195, // Efficiency (sword)\n209426660, // Defense (sword)\n1345609583, // Aim Assistance\n3555269338, // Zoom\n2715839340, // Recoil Direction\n4284893193, // Rounds Per Minute\n2961396640, // Charge Time\n447667954, // Draw Time\n3871231066, // Magazine\n1931675084, // Inventory Size\n925767036];\nexport const statsMs = [447667954, // Draw Time\n2961396640 // Charge Time\n];\nconst hiddenStatsWhitelist = [1345609583, // Aim Assistance\n3555269338, // Zoom\n2715839340 // Recoil Direction\n];\nexport function getMasterworks(theManifest, weaponHash) {\n  let manifest = theManifest;\n  const itemDef = manifest.DestinyInventoryItemDefinition[weaponHash];\n  const socketEntries = itemDef.sockets.socketEntries;\n  const y2MasterworkItems = manifest.DestinyPlugSetDefinition[1117738936].reusablePlugItems;\n  const statGroup = manifest.DestinyStatGroupDefinition[itemDef.stats.statGroupHash];\n  const statDisplays = statGroup.scaledStats;\n  const socketIndexes = itemDef.sockets.socketCategories.filter(c => c.socketCategoryHash === 2685412949)[0].socketIndexes;\n  let isY1 = false;\n  const isLegendary = itemDef.inventory.tierType === 5 ? true : false;\n  const isExotic = itemDef.inventory.tierType === 6 ? true : false;\n  let mwCollection = {\n    stability: {\n      benefits: [],\n      hash: 155624089,\n      active: false\n    },\n    range: {\n      benefits: [],\n      hash: 1240592695,\n      active: false\n    },\n    handling: {\n      benefits: [],\n      hash: 943549884,\n      active: false\n    },\n    damage: {\n      benefits: [],\n      hash: 4043523819,\n      active: false\n    },\n    // Impact\n    reload: {\n      benefits: [],\n      hash: 4188031367,\n      active: false\n    },\n    blast_radius: {\n      benefits: [],\n      hash: 3614673599,\n      active: false\n    },\n    projectile_speed: {\n      benefits: [],\n      hash: 2523465841,\n      active: false\n    },\n    // Velocity\n    charge_time: {\n      benefits: [],\n      hash: 2961396640,\n      active: false\n    },\n    draw_time: {\n      benefits: [],\n      hash: 447667954,\n      active: false\n    },\n    accuracy: {\n      benefits: [],\n      hash: 1591432999,\n      active: false\n    }\n  };\n\n  if (isLegendary) {\n    // const socketIndexes = itemDef.sockets.socketCategories.filter(c => c.socketCategoryHash === 2685412949)[0].socketIndexes;\n    socketIndexes.map(socket => {\n      if (socketEntries[socket].plugSources !== 3, socket.preventInitializationOnVendorPurchase !== true) {\n        const modDef = manifest.DestinyInventoryItemDefinition[socketEntries[socket].singleInitialItemHash];\n        const modIdentifiers = modDef.plug.plugCategoryIdentifier.split('.');\n\n        if (modIdentifiers.includes('v300', 'weapon')) {\n          isY1 = true;\n        }\n\n        return;\n      }\n    });\n\n    if (!isY1) {\n      // Map through the MW benefits.\n      y2MasterworkItems.map(mw => {\n        const mwDef = manifest.DestinyInventoryItemDefinition[mw.plugItemHash];\n        const mwStatSplit = mwDef.plug.plugCategoryIdentifier.split('.');\n        const mwStatName = mwStatSplit[mwStatSplit.length - 1];\n        mwCollection[mwStatName].benefits.push(mwDef);\n      });\n\n      for (const _ref of Object.entries(mwCollection)) {\n        var _ref2 = _slicedToArray(_ref, 2);\n\n        const statType = _ref2[0];\n        const data = _ref2[1];\n\n        if (shouldShowStat(itemDef, data.hash, statDisplays)) {\n          // Don't include Impact if it's not a fusion rifle.\n          if (itemDef.itemSubType !== 11 && statType === 'damage') {\n            mwCollection[statType].active = false;\n            continue;\n          }\n\n          mwCollection[statType].active = true;\n        } else {\n          mwCollection[statType].active = false;\n        }\n      }\n    } else {}\n  }\n\n  if (isExotic) {\n    socketIndexes.map(socket => {\n      const modDef = manifest.DestinyInventoryItemDefinition[socketEntries[socket]];\n      console.log(modDef);\n    });\n  } // console.log('isY1', isY1, mwCollection)\n\n\n  return mwCollection;\n} // function oldGetMasterworks(\n// \ttheManifest,\n// \tweaponHash\n// ) {\n// \t// console.log('----- Building masterworks. -----');\n// \tlet manifest = theManifest;\n// \tconst itemDef = manifest.DestinyInventoryItemDefinition[weaponHash];\n// \tconst sockets = itemDef.sockets;\n// \tconst socketEntries = itemDef.sockets.socketEntries;\n// \t// Place this here so it resets.\n// \tlet mwCollection = {\n// \t\tstability: { \n// \t\t\tbenefits: [], hash: 155624089, active: false,\n// \t\t},\n// \t\trange: { \n// \t\t\tbenefits: [], hash: 1240592695, active: false,\n// \t\t},\n// \t\thandling: { \n// \t\t\tbenefits: [], hash: 943549884, active: false,\n// \t\t},\n// \t\tdamage: { // Impact\n// \t\t\tbenefits: [],  hash: 4043523819, active: false,\n// \t\t},\n// \t\treload: { \n// \t\t\tbenefits: [], hash: 4188031367, active: false,\n// \t\t},\n// \t\tblast_radius: { \n// \t\t\tbenefits: [], hash: 3614673599, active: false,\n// \t\t},\n// \t\tprojectile_speed: { // Velocity\n// \t\t\tbenefits: [],  hash: 2523465841, active: false,\n// \t\t},\n// \t\tcharge_time: { \n// \t\t\tbenefits: [], hash: 2961396640, active: false,\n// \t\t},\n// \t\tdraw_time: { \n// \t\t\tbenefits: [], hash: 447667954, active: false,\n// \t\t},\n// \t\taccuracy: { \n// \t\t\tbenefits: [], hash: 1591432999, active: false,\n// \t\t},\n// \t};\n// \tif (!itemDef.sockets || !itemDef.sockets.socketEntries) {\n// \t\treturn null;\n// \t}\n// \tif (!socketEntries) {\n// \t\treturn null;\n// \t}\n// \tconst statGroup = manifest.DestinyStatGroupDefinition[itemDef.stats.statGroupHash];\n// \tconst statDisplays = statGroup.scaledStats;\n// \tif (!statGroup) {\n// \t\treturn null;\n// \t}\n// \tif ( !socketEntries.every(noRandomPerks) ) {\n// \t\t// Map through slots to find ones that are genuine perks.\n// \t\tsocketEntries.map(socket => {\n// \t\t\t// console.log(manifest.DestinyInventoryItemDefinition[socket.plugItemHash].itemCategoryHashes)\n// \t\t\t// console.log(socket)\n// \t\t\t// console.log(socket.socketCategories.filter(c => c.socketCategoryHash === 2685412949))\n// \t\t\tif (socket.plugSources === 3 // not perks\n// \t\t\t\t&& socket.preventInitializationOnVendorPurchase === true // something only MWs had???\n// \t\t\t\t&& socket.socketTypeHash !== 1288200359 // not default shader\n// \t\t\t) {\n// \t\t\t\t// Map through MW levels\n// \t\t\t\tsocket.reusablePlugItems.map(mw => {\n// \t\t\t\t\tconst mwDef = manifest.DestinyInventoryItemDefinition[mw.plugItemHash];\n// \t\t\t\t\tconst mwStatSplit = mwDef.plug.plugCategoryIdentifier.split('.');\n// \t\t\t\t\tconst mwStatName = mwStatSplit[mwStatSplit.length - 1];\n// \t\t\t\t\tmwCollection[mwStatName].benefits.push(mwDef);\n// \t\t\t\t\treturn true;\n// \t\t\t\t})\n// \t\t\t}\n// \t\t\treturn true;\n// \t\t})\n// \t}\n// \t// Filter out Masterworks that don't apply to this weapon.\n// \tfor (const [statType, data] of Object.entries(mwCollection)) {\n// \t\tif (shouldShowStat(itemDef, data.hash, statDisplays)) {\n// \t\t\t// Don't include Impact if it's not a fusion rifle.\n// \t\t\tif ( itemDef.itemSubType !== 11 && statType === 'damage'  ) {\n// \t\t\t\tmwCollection[statType].active = false;\n// \t\t\t\tcontinue;\n// \t\t\t}\n// \t\t\tmwCollection[statType].active = true;\n// \t\t} else {\n// \t\t\tmwCollection[statType].active = false;\n// \t\t}\n// \t}\n// \treturn mwCollection;\n// }\n// function noRandomPerks (\n// \tsocket\n// ) {\n// \treturn socket.hasOwnProperty('randomizedPlugSetHash')\n// }\n\nfunction shouldShowStat(itemDef, statHash, statDisplays) {\n  if (statHash === 2961396640 && itemDef.itemCategoryHashes && itemDef.itemCategoryHashes.includes(3317538576)) {\n    return false;\n  }\n\n  return (// Must be on the whitelist\n    statWhiteList.includes(statHash) && ( // Must be on the list of interpolated stats, or included in the hardcoded hidden stats list\n    statDisplays.filter(s => statHash === s.statHash)[0] || hiddenStatsWhitelist.includes(statHash))\n  );\n}","map":{"version":3,"sources":["/Users/aundrekerr/Projects/React2019/gunsmith3/src/utils/masterworks.js"],"names":["statWhiteList","statsMs","hiddenStatsWhitelist","getMasterworks","theManifest","weaponHash","manifest","itemDef","DestinyInventoryItemDefinition","socketEntries","sockets","y2MasterworkItems","DestinyPlugSetDefinition","reusablePlugItems","statGroup","DestinyStatGroupDefinition","stats","statGroupHash","statDisplays","scaledStats","socketIndexes","socketCategories","filter","c","socketCategoryHash","isY1","isLegendary","inventory","tierType","isExotic","mwCollection","stability","benefits","hash","active","range","handling","damage","reload","blast_radius","projectile_speed","charge_time","draw_time","accuracy","map","socket","plugSources","preventInitializationOnVendorPurchase","modDef","singleInitialItemHash","modIdentifiers","plug","plugCategoryIdentifier","split","includes","mw","mwDef","plugItemHash","mwStatSplit","mwStatName","length","push","Object","entries","statType","data","shouldShowStat","itemSubType","console","log","statHash","itemCategoryHashes","s"],"mappings":";AAAA,OAAO,MAAMA,aAAa,GAAG,CAC5B,UAD4B,EAChB;AACZ,UAF4B,EAEhB;AAEZ,UAJ4B,EAIhB;AACZ,UAL4B,EAKhB;AACZ,UAN4B,EAMhB;AACZ,SAP4B,EAOjB;AACX,SAR4B,EAQjB;AACX,UAT4B,EAShB;AAEZ,UAX4B,EAWhB;AACZ,UAZ4B,EAYhB;AACZ,SAb4B,EAajB;AAEX,UAf4B,EAehB;AACZ,UAhB4B,EAgBhB;AACZ,UAjB4B,EAiBhB;AAEZ,UAnB4B,EAmBhB;AACZ,UApB4B,EAoBhB;AACZ,SArB4B,EAqBjB;AAEX,UAvB4B,EAuBhB;AACZ,UAxB4B,EAwBhB;AACZ,SAzB4B,CAAtB;AA4BP,OAAO,MAAMC,OAAO,GAAG,CACtB,SADsB,EACX;AACX,UAFsB,CAEX;AAFW,CAAhB;AAKP,MAAMC,oBAAoB,GAAG,CAC5B,UAD4B,EAChB;AACZ,UAF4B,EAEhB;AACZ,UAH4B,CAGjB;AAHiB,CAA7B;AAOA,OAAO,SAASC,cAAT,CACNC,WADM,EAENC,UAFM,EAGL;AACD,MAAIC,QAAQ,GAAGF,WAAf;AACA,QAAMG,OAAO,GAAGD,QAAQ,CAACE,8BAAT,CAAwCH,UAAxC,CAAhB;AACA,QAAMI,aAAa,GAAGF,OAAO,CAACG,OAAR,CAAgBD,aAAtC;AACA,QAAME,iBAAiB,GAAGL,QAAQ,CAACM,wBAAT,CAAkC,UAAlC,EAA8CC,iBAAxE;AACA,QAAMC,SAAS,GAAGR,QAAQ,CAACS,0BAAT,CAAoCR,OAAO,CAACS,KAAR,CAAcC,aAAlD,CAAlB;AACA,QAAMC,YAAY,GAAGJ,SAAS,CAACK,WAA/B;AACA,QAAMC,aAAa,GAAGb,OAAO,CAACG,OAAR,CAAgBW,gBAAhB,CAAiCC,MAAjC,CAAwCC,CAAC,IAAIA,CAAC,CAACC,kBAAF,KAAyB,UAAtE,EAAkF,CAAlF,EAAqFJ,aAA3G;AACA,MAAIK,IAAI,GAAG,KAAX;AACA,QAAMC,WAAW,GAAGnB,OAAO,CAACoB,SAAR,CAAkBC,QAAlB,KAA+B,CAA/B,GAAmC,IAAnC,GAA0C,KAA9D;AACA,QAAMC,QAAQ,GAAGtB,OAAO,CAACoB,SAAR,CAAkBC,QAAlB,KAA+B,CAA/B,GAAmC,IAAnC,GAA0C,KAA3D;AAEA,MAAIE,YAAY,GAAG;AAClBC,IAAAA,SAAS,EAAE;AAAEC,MAAAA,QAAQ,EAAE,EAAZ;AAAgBC,MAAAA,IAAI,EAAE,SAAtB;AAAiCC,MAAAA,MAAM,EAAE;AAAzC,KADO;AAElBC,IAAAA,KAAK,EAAE;AAAEH,MAAAA,QAAQ,EAAE,EAAZ;AAAgBC,MAAAA,IAAI,EAAE,UAAtB;AAAkCC,MAAAA,MAAM,EAAE;AAA1C,KAFW;AAGlBE,IAAAA,QAAQ,EAAE;AAAEJ,MAAAA,QAAQ,EAAE,EAAZ;AAAgBC,MAAAA,IAAI,EAAE,SAAtB;AAAiCC,MAAAA,MAAM,EAAE;AAAzC,KAHQ;AAIlBG,IAAAA,MAAM,EAAE;AAAEL,MAAAA,QAAQ,EAAE,EAAZ;AAAiBC,MAAAA,IAAI,EAAE,UAAvB;AAAmCC,MAAAA,MAAM,EAAE;AAA3C,KAJU;AAI2C;AAC7DI,IAAAA,MAAM,EAAE;AAAEN,MAAAA,QAAQ,EAAE,EAAZ;AAAgBC,MAAAA,IAAI,EAAE,UAAtB;AAAkCC,MAAAA,MAAM,EAAE;AAA1C,KALU;AAMlBK,IAAAA,YAAY,EAAE;AAAEP,MAAAA,QAAQ,EAAE,EAAZ;AAAgBC,MAAAA,IAAI,EAAE,UAAtB;AAAkCC,MAAAA,MAAM,EAAE;AAA1C,KANI;AAOlBM,IAAAA,gBAAgB,EAAE;AAAER,MAAAA,QAAQ,EAAE,EAAZ;AAAiBC,MAAAA,IAAI,EAAE,UAAvB;AAAmCC,MAAAA,MAAM,EAAE;AAA3C,KAPA;AAOqD;AACvEO,IAAAA,WAAW,EAAE;AAAET,MAAAA,QAAQ,EAAE,EAAZ;AAAgBC,MAAAA,IAAI,EAAE,UAAtB;AAAkCC,MAAAA,MAAM,EAAE;AAA1C,KARK;AASlBQ,IAAAA,SAAS,EAAE;AAAEV,MAAAA,QAAQ,EAAE,EAAZ;AAAgBC,MAAAA,IAAI,EAAE,SAAtB;AAAiCC,MAAAA,MAAM,EAAE;AAAzC,KATO;AAUlBS,IAAAA,QAAQ,EAAE;AAAEX,MAAAA,QAAQ,EAAE,EAAZ;AAAgBC,MAAAA,IAAI,EAAE,UAAtB;AAAkCC,MAAAA,MAAM,EAAE;AAA1C;AAVQ,GAAnB;;AAcA,MAAKR,WAAL,EAAmB;AAClB;AAEAN,IAAAA,aAAa,CAACwB,GAAd,CAAkBC,MAAM,IAAI;AAC3B,UACCpC,aAAa,CAACoC,MAAD,CAAb,CAAsBC,WAAtB,KAAsC,CAAtC,EACAD,MAAM,CAACE,qCAAP,KAAiD,IAFlD,EAGE;AACD,cAAMC,MAAM,GAAG1C,QAAQ,CAACE,8BAAT,CAAwCC,aAAa,CAACoC,MAAD,CAAb,CAAsBI,qBAA9D,CAAf;AACA,cAAMC,cAAc,GAAGF,MAAM,CAACG,IAAP,CAAYC,sBAAZ,CAAmCC,KAAnC,CAAyC,GAAzC,CAAvB;;AAEA,YAAIH,cAAc,CAACI,QAAf,CAAwB,MAAxB,EAAgC,QAAhC,CAAJ,EAA+C;AAC9C7B,UAAAA,IAAI,GAAG,IAAP;AACA;;AAED;AACA;AACD,KAdD;;AAgBA,QAAI,CAACA,IAAL,EAAU;AACT;AACAd,MAAAA,iBAAiB,CAACiC,GAAlB,CAAsBW,EAAE,IAAI;AAC3B,cAAMC,KAAK,GAAGlD,QAAQ,CAACE,8BAAT,CAAwC+C,EAAE,CAACE,YAA3C,CAAd;AACA,cAAMC,WAAW,GAAGF,KAAK,CAACL,IAAN,CAAWC,sBAAX,CAAkCC,KAAlC,CAAwC,GAAxC,CAApB;AACA,cAAMM,UAAU,GAAGD,WAAW,CAACA,WAAW,CAACE,MAAZ,GAAqB,CAAtB,CAA9B;AAEA9B,QAAAA,YAAY,CAAC6B,UAAD,CAAZ,CAAyB3B,QAAzB,CAAkC6B,IAAlC,CAAuCL,KAAvC;AACA,OAND;;AAQA,yBAA+BM,MAAM,CAACC,OAAP,CAAejC,YAAf,CAA/B,EAA6D;AAAA;;AAAA,cAAjDkC,QAAiD;AAAA,cAAvCC,IAAuC;;AAC5D,YAAIC,cAAc,CAAC3D,OAAD,EAAU0D,IAAI,CAAChC,IAAf,EAAqBf,YAArB,CAAlB,EAAsD;AAErD;AACA,cAAKX,OAAO,CAAC4D,WAAR,KAAwB,EAAxB,IAA8BH,QAAQ,KAAK,QAAhD,EAA4D;AAC3DlC,YAAAA,YAAY,CAACkC,QAAD,CAAZ,CAAuB9B,MAAvB,GAAgC,KAAhC;AACA;AACA;;AAEDJ,UAAAA,YAAY,CAACkC,QAAD,CAAZ,CAAuB9B,MAAvB,GAAgC,IAAhC;AACA,SATD,MASO;AACNJ,UAAAA,YAAY,CAACkC,QAAD,CAAZ,CAAuB9B,MAAvB,GAAgC,KAAhC;AACA;AACD;AACD,KAxBD,MAwBO,CAEN;AACD;;AAED,MAAKL,QAAL,EAAgB;AAGfT,IAAAA,aAAa,CAACwB,GAAd,CAAkBC,MAAM,IAAI;AAC3B,YAAMG,MAAM,GAAG1C,QAAQ,CAACE,8BAAT,CAAwCC,aAAa,CAACoC,MAAD,CAArD,CAAf;AAEAuB,MAAAA,OAAO,CAACC,GAAR,CAAYrB,MAAZ;AACA,KAJD;AAKA,GAlFA,CAoFD;;;AACA,SAAOlB,YAAP;AACA,C,CAID;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAIA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;;AAEA,SAASoC,cAAT,CACC3D,OADD,EAEC+D,QAFD,EAGCpD,YAHD,EAIE;AACD,MACCoD,QAAQ,KAAK,UAAb,IACA/D,OAAO,CAACgE,kBADR,IAEAhE,OAAO,CAACgE,kBAAR,CAA2BjB,QAA3B,CAAoC,UAApC,CAHD,EAIE;AACD,WAAO,KAAP;AACA;;AAED,SACC;AACAtD,IAAAA,aAAa,CAACsD,QAAd,CAAuBgB,QAAvB,OACA;AACCpD,IAAAA,YAAY,CAACI,MAAb,CAAoBkD,CAAC,IAAIF,QAAQ,KAAKE,CAAC,CAACF,QAAxC,EAAkD,CAAlD,KAAwDpE,oBAAoB,CAACoD,QAArB,CAA8BgB,QAA9B,CAFzD;AAFD;AAMA","sourcesContent":["export const statWhiteList = [\n\t3614673599, // Blast Radius\n\t2523465841, // Velocity\n\n\t4043523819, // Impact\n\t1240592695, // Range\n\t1591432999, // Accuracy\n\t155624089, // Stability\n\t943549884, // Handling\n\t4188031367, // Reload Speed\n\n\t2837207746, // Swing Speed (sword)\n\t2762071195, // Efficiency (sword)\n\t209426660, // Defense (sword)\n\t\n\t1345609583, // Aim Assistance\n\t3555269338, // Zoom\n\t2715839340, // Recoil Direction\n\n\t4284893193, // Rounds Per Minute\n\t2961396640, // Charge Time\n\t447667954, // Draw Time\n\n\t3871231066, // Magazine\n\t1931675084, // Inventory Size\n\t925767036, // Ammo Capacity\n];\n\nexport const statsMs = [\n\t447667954, // Draw Time\n\t2961396640 // Charge Time\n];\n\nconst hiddenStatsWhitelist = [\n\t1345609583, // Aim Assistance\n\t3555269338, // Zoom\n\t2715839340 // Recoil Direction\n];\n\n\nexport function getMasterworks(\n\ttheManifest,\n\tweaponHash\n) {\n\tlet manifest = theManifest;\n\tconst itemDef = manifest.DestinyInventoryItemDefinition[weaponHash];\n\tconst socketEntries = itemDef.sockets.socketEntries;\n\tconst y2MasterworkItems = manifest.DestinyPlugSetDefinition[1117738936].reusablePlugItems;\n\tconst statGroup = manifest.DestinyStatGroupDefinition[itemDef.stats.statGroupHash];\n\tconst statDisplays = statGroup.scaledStats;\n\tconst socketIndexes = itemDef.sockets.socketCategories.filter(c => c.socketCategoryHash === 2685412949)[0].socketIndexes;\n\tlet isY1 = false;\n\tconst isLegendary = itemDef.inventory.tierType === 5 ? true : false;\n\tconst isExotic = itemDef.inventory.tierType === 6 ? true : false;\n\n\tlet mwCollection = {\n\t\tstability: { benefits: [], hash: 155624089, active: false, },\n\t\trange: { benefits: [], hash: 1240592695, active: false, },\n\t\thandling: { benefits: [], hash: 943549884, active: false, },\n\t\tdamage: { benefits: [],  hash: 4043523819, active: false, }, // Impact\n\t\treload: { benefits: [], hash: 4188031367, active: false, },\n\t\tblast_radius: { benefits: [], hash: 3614673599, active: false, },\n\t\tprojectile_speed: { benefits: [],  hash: 2523465841, active: false, }, // Velocity\n\t\tcharge_time: { benefits: [], hash: 2961396640, active: false, },\n\t\tdraw_time: { benefits: [], hash: 447667954, active: false, },\n\t\taccuracy: { benefits: [], hash: 1591432999, active: false, },\n\t};\n\t\n\n\tif ( isLegendary ) {\n\t\t// const socketIndexes = itemDef.sockets.socketCategories.filter(c => c.socketCategoryHash === 2685412949)[0].socketIndexes;\n\t\n\t\tsocketIndexes.map(socket => {\n\t\t\tif (\n\t\t\t\tsocketEntries[socket].plugSources !== 3,\n\t\t\t\tsocket.preventInitializationOnVendorPurchase !== true \n\t\t\t) {\n\t\t\t\tconst modDef = manifest.DestinyInventoryItemDefinition[socketEntries[socket].singleInitialItemHash];\n\t\t\t\tconst modIdentifiers = modDef.plug.plugCategoryIdentifier.split('.');\n\t\t\n\t\t\t\tif (modIdentifiers.includes('v300', 'weapon')) {\n\t\t\t\t\tisY1 = true;\n\t\t\t\t}\n\t\t\n\t\t\t\treturn;\n\t\t\t}\n\t\t});\n\n\t\tif (!isY1){\n\t\t\t// Map through the MW benefits.\n\t\t\ty2MasterworkItems.map(mw => {\n\t\t\t\tconst mwDef = manifest.DestinyInventoryItemDefinition[mw.plugItemHash];\n\t\t\t\tconst mwStatSplit = mwDef.plug.plugCategoryIdentifier.split('.');\n\t\t\t\tconst mwStatName = mwStatSplit[mwStatSplit.length - 1];\n\t\t\t\t\n\t\t\t\tmwCollection[mwStatName].benefits.push(mwDef);\n\t\t\t});\n\n\t\t\tfor (const [statType, data] of Object.entries(mwCollection)) {\n\t\t\t\tif (shouldShowStat(itemDef, data.hash, statDisplays)) {\n\n\t\t\t\t\t// Don't include Impact if it's not a fusion rifle.\n\t\t\t\t\tif ( itemDef.itemSubType !== 11 && statType === 'damage'  ) {\n\t\t\t\t\t\tmwCollection[statType].active = false;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tmwCollection[statType].active = true;\n\t\t\t\t} else {\n\t\t\t\t\tmwCollection[statType].active = false;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\n\t\t}\n\t}\n\n\tif ( isExotic ) {\n\t\t\n\t\t\n\t\tsocketIndexes.map(socket => {\n\t\t\tconst modDef = manifest.DestinyInventoryItemDefinition[socketEntries[socket]];\n\n\t\t\tconsole.log(modDef)\n\t\t})\n\t}\n\n\t// console.log('isY1', isY1, mwCollection)\n\treturn mwCollection;\n}\n\n\n\n// function oldGetMasterworks(\n// \ttheManifest,\n// \tweaponHash\n// ) {\n// \t// console.log('----- Building masterworks. -----');\n// \tlet manifest = theManifest;\n// \tconst itemDef = manifest.DestinyInventoryItemDefinition[weaponHash];\n// \tconst sockets = itemDef.sockets;\n// \tconst socketEntries = itemDef.sockets.socketEntries;\n\n// \t// Place this here so it resets.\n// \tlet mwCollection = {\n// \t\tstability: { \n// \t\t\tbenefits: [], hash: 155624089, active: false,\n// \t\t},\n// \t\trange: { \n// \t\t\tbenefits: [], hash: 1240592695, active: false,\n// \t\t},\n// \t\thandling: { \n// \t\t\tbenefits: [], hash: 943549884, active: false,\n// \t\t},\n// \t\tdamage: { // Impact\n// \t\t\tbenefits: [],  hash: 4043523819, active: false,\n// \t\t},\n// \t\treload: { \n// \t\t\tbenefits: [], hash: 4188031367, active: false,\n// \t\t},\n// \t\tblast_radius: { \n// \t\t\tbenefits: [], hash: 3614673599, active: false,\n// \t\t},\n// \t\tprojectile_speed: { // Velocity\n// \t\t\tbenefits: [],  hash: 2523465841, active: false,\n// \t\t},\n// \t\tcharge_time: { \n// \t\t\tbenefits: [], hash: 2961396640, active: false,\n// \t\t},\n// \t\tdraw_time: { \n// \t\t\tbenefits: [], hash: 447667954, active: false,\n// \t\t},\n// \t\taccuracy: { \n// \t\t\tbenefits: [], hash: 1591432999, active: false,\n// \t\t},\n// \t};\n\n// \tif (!itemDef.sockets || !itemDef.sockets.socketEntries) {\n// \t\treturn null;\n// \t}\n\n// \tif (!socketEntries) {\n// \t\treturn null;\n// \t}\n\n// \tconst statGroup = manifest.DestinyStatGroupDefinition[itemDef.stats.statGroupHash];\n// \tconst statDisplays = statGroup.scaledStats;\n// \tif (!statGroup) {\n// \t\treturn null;\n// \t}\n\n\t\n\n// \tif ( !socketEntries.every(noRandomPerks) ) {\n// \t\t// Map through slots to find ones that are genuine perks.\n// \t\tsocketEntries.map(socket => {\n\n// \t\t\t// console.log(manifest.DestinyInventoryItemDefinition[socket.plugItemHash].itemCategoryHashes)\n// \t\t\t// console.log(socket)\n// \t\t\t// console.log(socket.socketCategories.filter(c => c.socketCategoryHash === 2685412949))\n\n// \t\t\tif (socket.plugSources === 3 // not perks\n// \t\t\t\t&& socket.preventInitializationOnVendorPurchase === true // something only MWs had???\n// \t\t\t\t&& socket.socketTypeHash !== 1288200359 // not default shader\n// \t\t\t) {\n// \t\t\t\t// Map through MW levels\n// \t\t\t\tsocket.reusablePlugItems.map(mw => {\n// \t\t\t\t\tconst mwDef = manifest.DestinyInventoryItemDefinition[mw.plugItemHash];\n// \t\t\t\t\tconst mwStatSplit = mwDef.plug.plugCategoryIdentifier.split('.');\n// \t\t\t\t\tconst mwStatName = mwStatSplit[mwStatSplit.length - 1];\n\t\t\t\t\t\n// \t\t\t\t\tmwCollection[mwStatName].benefits.push(mwDef);\n// \t\t\t\t\treturn true;\n// \t\t\t\t})\n// \t\t\t}\n\n// \t\t\treturn true;\n// \t\t})\n// \t}\n\n// \t// Filter out Masterworks that don't apply to this weapon.\n// \tfor (const [statType, data] of Object.entries(mwCollection)) {\n// \t\tif (shouldShowStat(itemDef, data.hash, statDisplays)) {\n\n// \t\t\t// Don't include Impact if it's not a fusion rifle.\n// \t\t\tif ( itemDef.itemSubType !== 11 && statType === 'damage'  ) {\n// \t\t\t\tmwCollection[statType].active = false;\n// \t\t\t\tcontinue;\n// \t\t\t}\n\t\t\t\n// \t\t\tmwCollection[statType].active = true;\n// \t\t} else {\n// \t\t\tmwCollection[statType].active = false;\n// \t\t}\n// \t}\n\n// \treturn mwCollection;\n// }\n\n// function noRandomPerks (\n// \tsocket\n// ) {\n// \treturn socket.hasOwnProperty('randomizedPlugSetHash')\n// }\n\nfunction shouldShowStat (\n\titemDef, \n\tstatHash, \n\tstatDisplays\n) {\n\tif (\n\t\tstatHash === 2961396640 &&\n\t\titemDef.itemCategoryHashes &&\n\t\titemDef.itemCategoryHashes.includes(3317538576)\n\t) {\n\t\treturn false;\n\t}\n\n\treturn (\n\t\t// Must be on the whitelist\n\t\tstatWhiteList.includes(statHash) &&\n\t\t// Must be on the list of interpolated stats, or included in the hardcoded hidden stats list\n\t\t(statDisplays.filter(s => statHash === s.statHash)[0] || hiddenStatsWhitelist.includes(statHash))\n\t);\n}"]},"metadata":{},"sourceType":"module"}