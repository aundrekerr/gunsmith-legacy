{"ast":null,"code":"var _jsxFileName = \"/Users/aundrekerr/Projects/React2019/gunsmith3/src/components/Search/index.js\";\nimport React, { Component } from 'react';\nimport ReactDOM from 'react-dom';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport SearchInput from './SearchInput';\nimport Filters from './Filters';\nimport Suggestions from './Suggestions';\nimport { storeWeapon } from './../../actions/weaponActions';\nimport { storeRarity, storeWeaponType, storeDamage } from './../../actions/filterActions';\n\nclass Search extends Component {\n  constructor(props) {\n    super(props);\n\n    this.updateSuggestions = (input, from = {}) => {\n      const weaponList = this.state.weaponList;\n      let _this$props$filters = this.props.filters,\n          rarity = _this$props$filters.rarity,\n          weaponType = _this$props$filters.weaponType,\n          damage = _this$props$filters.damage;\n      let userInput = this.state.userInput; // If the input field sends over data, make that the new input data to filter with.\n\n      if (input) userInput = input; // If a select field sends over a new filter, update the settings here.\n\n      if (from.hasOwnProperty('rarity')) rarity = from.rarity;\n      if (from.hasOwnProperty('weaponType')) weaponType = from.weaponType;\n      if (from.hasOwnProperty('damage')) damage = from.damage; // Filter through the full weapons list based on the select field filters.\n\n      let filteredList = weaponList;\n      if (rarity) filteredList = filteredList.filter(weapon => {\n        return weapon.inventory.tierTypeHash === rarity;\n      });\n      if (weaponType) filteredList = filteredList.filter(weapon => {\n        return weapon.itemSubType === weaponType;\n      });\n      if (damage) filteredList = filteredList.filter(weapon => {\n        return weapon.defaultDamageTypeHash === damage;\n      }); // Filter through what's left based on the input field.\n\n      let suggestions = filteredList.filter(suggestion => suggestion.displayProperties.name.toLowerCase().indexOf(userInput.toLowerCase()) > -1); // Set the new list and give the OK to display the suggestions.\n\n      this.setState({\n        filteredSuggestions: suggestions,\n        showSuggestions: true\n      });\n    };\n\n    this.onInputChange = e => {\n      this.setState({\n        userInput: e.currentTarget.value\n      });\n      this.updateSuggestions(e.currentTarget.value);\n    };\n\n    this.changeRarity = e => {\n      let toStore = e.target.value === 0 ? null : parseInt(e.target.value);\n      this.setState({\n        currentRarity: toStore\n      });\n      this.props.storeRarity(toStore);\n      this.updateSuggestions(this.state.userInput, {\n        rarity: toStore\n      });\n    };\n\n    this.changeWeaponType = e => {\n      let toStore = e.target.value === 0 ? null : parseInt(e.target.value);\n      this.setState({\n        currentWeaponType: toStore\n      });\n      this.props.storeWeaponType(toStore);\n      this.updateSuggestions(this.state.userInput, {\n        weaponType: toStore\n      });\n    };\n\n    this.changeDamage = e => {\n      let toStore = e.target.value === 0 ? null : parseInt(e.target.value);\n      this.setState({\n        currentDamage: toStore\n      });\n      this.props.storeDamage(toStore);\n      this.updateSuggestions(this.state.userInput, {\n        damage: toStore\n      });\n    };\n\n    this.onSuggestionClick = hash => {\n      // console.log(hash)\n      this.props.storeWeapon(hash); // this.props.storePerks(null, 0);\n      // this.props.storePerks(null, 1);\n      // this.props.storePerks(null, 2);\n      // this.props.storePerks(null, 3);\n      // this.setState({\n      // \tactiveSuggestion: 0,\n      // \tfilteredSuggestions: [],\n      // \tshowSuggestions: false,\n      // \tuserInput: ''\n      // })\n      // console.log()\n    };\n\n    this.getRefData = () => {\n      let input = this.inputElem;\n      let filters = this.filtersElem;\n      let header = this.headerElem;\n      const inputDomNode = ReactDOM.findDOMNode(input);\n      const filtersDomNode = ReactDOM.findDOMNode(filters);\n      const headerDomNode = ReactDOM.findDOMNode(header);\n      console.log(headerDomNode);\n      input = inputDomNode.getBoundingClientRect();\n      filters = filtersDomNode.getBoundingClientRect();\n      header = headerDomNode.getBoundingClientRect();\n      return {\n        filters,\n        input,\n        header\n      };\n    };\n\n    this.state = {\n      weaponList: [],\n      filteredSuggestions: [],\n      showSuggestions: false,\n      userInput: '',\n      currentRarity: 4008398120,\n      currentWeaponType: 0,\n      currentDamage: 0\n    };\n  }\n\n  componentDidMount(prevProps) {\n    const manifest = this.props.manifest;\n    const currentRarity = this.state.currentRarity;\n    let fullList = []; // All Weapons\n\n    Object.keys(manifest.DestinyInventoryItemDefinition).map(weapon => {\n      return manifest.DestinyInventoryItemDefinition[weapon].itemType === 3 ? fullList.push(manifest.DestinyInventoryItemDefinition[weapon]) : null;\n    });\n    let filteredList = fullList.filter(weapon => {\n      return weapon.inventory.tierTypeHash === currentRarity;\n    });\n    this.setState({\n      filteredSuggestions: filteredList,\n      weaponList: fullList\n    });\n  }\n\n  componentDidUpdate() {}\n\n  render() {\n    const onInputChange = this.onInputChange,\n          changeRarity = this.changeRarity,\n          changeWeaponType = this.changeWeaponType,\n          changeDamage = this.changeDamage,\n          onSuggestionClick = this.onSuggestionClick,\n          _this$state = this.state,\n          weaponList = _this$state.weaponList,\n          filteredSuggestions = _this$state.filteredSuggestions,\n          showSuggestions = _this$state.showSuggestions,\n          userInput = _this$state.userInput,\n          currentRarity = _this$state.currentRarity,\n          currentWeaponType = _this$state.currentWeaponType,\n          currentDamage = _this$state.currentDamage,\n          manifestLoaded = this.props.manifestLoaded;\n    return React.createElement(\"div\", {\n      className: \"search__wrapper\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167\n      },\n      __self: this\n    }, React.createElement(SearchInput, {\n      onInputChange: onInputChange,\n      userInput: userInput,\n      manifestLoaded: manifestLoaded,\n      inputRef: el => this.inputElem = el,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168\n      },\n      __self: this\n    }), React.createElement(Filters, {\n      changeRarity: changeRarity,\n      changeWeaponType: changeWeaponType,\n      changeDamage: changeDamage,\n      currentRarity: currentRarity,\n      currentWeaponType: currentWeaponType,\n      currentDamage: currentDamage,\n      filtersRef: el => this.filtersElem = el,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174\n      },\n      __self: this\n    }), React.createElement(Suggestions, {\n      weaponList: weaponList,\n      filteredSuggestions: filteredSuggestions,\n      showSuggestions: showSuggestions,\n      userInput: userInput,\n      onSuggestionClick: onSuggestionClick,\n      getRefData: () => this.getRefData(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183\n      },\n      __self: this\n    }));\n  }\n\n}\n\nSearch.propTypes = {\n  storeWeapon: PropTypes.func.isRequired,\n  storeRarity: PropTypes.func.isRequired,\n  storeWeaponType: PropTypes.func.isRequired,\n  storeDamage: PropTypes.func.isRequired\n};\n\nconst mapStateToProps = state => ({\n  manifest: state.manifest,\n  manifestLoaded: state.manifestLoaded,\n  filters: state.filters,\n  weapon: state.weapon\n});\n\nexport default connect(mapStateToProps, {\n  storeWeapon,\n  storeRarity,\n  storeWeaponType,\n  storeDamage\n})(Search);","map":{"version":3,"sources":["/Users/aundrekerr/Projects/React2019/gunsmith3/src/components/Search/index.js"],"names":["React","Component","ReactDOM","PropTypes","connect","SearchInput","Filters","Suggestions","storeWeapon","storeRarity","storeWeaponType","storeDamage","Search","constructor","props","updateSuggestions","input","from","weaponList","state","filters","rarity","weaponType","damage","userInput","hasOwnProperty","filteredList","filter","weapon","inventory","tierTypeHash","itemSubType","defaultDamageTypeHash","suggestions","suggestion","displayProperties","name","toLowerCase","indexOf","setState","filteredSuggestions","showSuggestions","onInputChange","e","currentTarget","value","changeRarity","toStore","target","parseInt","currentRarity","changeWeaponType","currentWeaponType","changeDamage","currentDamage","onSuggestionClick","hash","getRefData","inputElem","filtersElem","header","headerElem","inputDomNode","findDOMNode","filtersDomNode","headerDomNode","console","log","getBoundingClientRect","componentDidMount","prevProps","manifest","fullList","Object","keys","DestinyInventoryItemDefinition","map","itemType","push","componentDidUpdate","render","manifestLoaded","el","propTypes","func","isRequired","mapStateToProps"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport ReactDOM from 'react-dom';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport SearchInput from './SearchInput';\nimport Filters from './Filters';\nimport Suggestions from './Suggestions';\nimport { storeWeapon } from './../../actions/weaponActions';\nimport { storeRarity, storeWeaponType, storeDamage } from './../../actions/filterActions';\n\nclass Search extends Component {\n\tconstructor(props) {\n\t\tsuper(props)\n\n\t\tthis.state = {\n\t\t\tweaponList: [],\n\t\t\tfilteredSuggestions: [],\n\t\t\tshowSuggestions: false,\n\t\t\tuserInput: '',\n\t\t\tcurrentRarity: 4008398120,\n\t\t\tcurrentWeaponType: 0,\n\t\t\tcurrentDamage: 0,\n\t\t}\n\t}\n\n\tcomponentDidMount(prevProps) {\n\t\tconst { manifest } = this.props;\n\t\tconst { currentRarity } = this.state;\n\t\t\n\t\tlet fullList = [];\n\t\t\n\t\t// All Weapons\n\t\tObject.keys(manifest.DestinyInventoryItemDefinition).map(weapon => {\n\t\t\treturn manifest.DestinyInventoryItemDefinition[weapon].itemType === 3\n\t\t\t\t? fullList.push(manifest.DestinyInventoryItemDefinition[weapon])\n\t\t\t\t: null\n\t\t})\n\n\t\tlet filteredList = fullList.filter(weapon => { \n\t\t\treturn weapon.inventory.tierTypeHash === currentRarity\n\t\t})\n\n\t\tthis.setState({ \n\t\t\tfilteredSuggestions: filteredList,\n\t\t\tweaponList: fullList\n\t\t})\n\t}\n\n\tcomponentDidUpdate() {\n\t\t\n\t}\n\n\tupdateSuggestions = (input, from = {}) => {\n\t\tconst { weaponList } = this.state;\n\t\tlet { rarity, weaponType, damage } = this.props.filters;\n\t\tlet { userInput } = this.state;\n\n\t\t// If the input field sends over data, make that the new input data to filter with.\n\t\tif (input) userInput = input;\t\n\t\t\n\t\t// If a select field sends over a new filter, update the settings here.\n\t\tif ( from.hasOwnProperty('rarity') ) rarity = from.rarity;\n\t\tif ( from.hasOwnProperty('weaponType') ) weaponType = from.weaponType;\n\t\tif ( from.hasOwnProperty('damage') ) damage = from.damage;\n\n\t\t// Filter through the full weapons list based on the select field filters.\n\t\tlet filteredList = weaponList;\n\t\tif (rarity) filteredList = filteredList.filter(weapon => { return weapon.inventory.tierTypeHash === rarity });\n\t\tif (weaponType) filteredList = filteredList.filter(weapon => { return weapon.itemSubType === weaponType });\n\t\tif (damage) filteredList = filteredList.filter(weapon => { return weapon.defaultDamageTypeHash === damage });\n\n\t\t// Filter through what's left based on the input field.\n\t\tlet suggestions = filteredList.filter( suggestion => (suggestion.displayProperties.name).toLowerCase().indexOf(userInput.toLowerCase()) > -1 );\n\n\t\t// Set the new list and give the OK to display the suggestions.\n\t\tthis.setState({\n\t\t\tfilteredSuggestions: suggestions,\n\t\t\tshowSuggestions: true,\n\t\t})\n\t}\n\n\t// SearchInput.js\n\tonInputChange = e => {\n\t\tthis.setState({\n\t\t\tuserInput: e.currentTarget.value\n\t\t})\n\n\t\tthis.updateSuggestions(e.currentTarget.value);\n\t}\n\n\t// Filters.js\n\tchangeRarity = (e) => {\n\t\tlet toStore = e.target.value === 0 ? null : parseInt(e.target.value);\n\t\tthis.setState({ currentRarity: toStore }); \n\t\tthis.props.storeRarity(toStore);\n\t\tthis.updateSuggestions(this.state.userInput, { rarity: toStore });\n\t}\n\tchangeWeaponType = (e) => {\n\t\tlet toStore = e.target.value === 0 ? null : parseInt(e.target.value);\n\t\tthis.setState({ currentWeaponType: toStore }); \n\t\tthis.props.storeWeaponType(toStore);\n\t\tthis.updateSuggestions(this.state.userInput, { weaponType: toStore });\n\t}\n\tchangeDamage = (e) => {\n\t\tlet toStore = e.target.value === 0 ? null : parseInt(e.target.value);\n\t\tthis.setState({ currentDamage: toStore }); \n\t\tthis.props.storeDamage(toStore);\n\t\tthis.updateSuggestions(this.state.userInput, { damage: toStore });\n\t}\n\t\n\n\tonSuggestionClick = (hash) => {\n\t\t// console.log(hash)\n\t\tthis.props.storeWeapon(hash);\t\n\t\t// this.props.storePerks(null, 0);\n\t\t// this.props.storePerks(null, 1);\n\t\t// this.props.storePerks(null, 2);\n\t\t// this.props.storePerks(null, 3);\n\n\t\t// this.setState({\n\t\t// \tactiveSuggestion: 0,\n\t\t// \tfilteredSuggestions: [],\n\t\t// \tshowSuggestions: false,\n\t\t// \tuserInput: ''\n\t\t// })\n\n\t\t// console.log()\n\t}\n\n\tgetRefData = () => {\n\t\tlet input = this.inputElem;\n\t\tlet filters = this.filtersElem;\n\t\tlet header = this.headerElem;\n\t\tconst inputDomNode = ReactDOM.findDOMNode(input);\n\t\tconst filtersDomNode = ReactDOM.findDOMNode(filters);\n\t\tconst headerDomNode = ReactDOM.findDOMNode(header);\n\t\tconsole.log(headerDomNode)\n\t\tinput = inputDomNode.getBoundingClientRect();\n\t\tfilters = filtersDomNode.getBoundingClientRect();\n\t\theader = headerDomNode.getBoundingClientRect();\n\n\t\treturn { filters, input, header };\n\t}\n\n\trender() {\n\t\tconst {\n\t\t\tonInputChange,\n\t\t\tchangeRarity,\n\t\t\tchangeWeaponType,\n\t\t\tchangeDamage,\n\t\t\tonSuggestionClick,\n\t\t\tstate: {\n\t\t\t\tweaponList,\n\t\t\t\tfilteredSuggestions,\n\t\t\t\tshowSuggestions,\n\t\t\t\tuserInput,\n\t\t\t\tcurrentRarity,\n\t\t\t\tcurrentWeaponType,\n\t\t\t\tcurrentDamage,\n\t\t\t},\n\t\t\tprops: {\n\t\t\t\tmanifestLoaded\n\t\t\t}\n\t\t} = this;\n\t\t\n\t\treturn (\n\t\t\t<div className=\"search__wrapper\">\n\t\t\t\t<SearchInput \n\t\t\t\t\tonInputChange={ onInputChange }\n\t\t\t\t\tuserInput={ userInput }\n\t\t\t\t\tmanifestLoaded={ manifestLoaded }\n\t\t\t\t\tinputRef={el => this.inputElem = el}\n\t\t\t\t/>\n\t\t\t\t<Filters \n\t\t\t\t\tchangeRarity={ changeRarity }\n\t\t\t\t\tchangeWeaponType={ changeWeaponType }\n\t\t\t\t\tchangeDamage={ changeDamage }\n\t\t\t\t\tcurrentRarity={ currentRarity }\n\t\t\t\t\tcurrentWeaponType={ currentWeaponType }\n\t\t\t\t\tcurrentDamage={ currentDamage }\n\t\t\t\t\tfiltersRef={el => this.filtersElem = el}\n\t\t\t\t/>\n\t\t\t\t<Suggestions \n\t\t\t\t\tweaponList={ weaponList }\n\t\t\t\t\tfilteredSuggestions={ filteredSuggestions }\n\t\t\t\t\tshowSuggestions={ showSuggestions }\n\t\t\t\t\tuserInput={ userInput }\n\t\t\t\t\tonSuggestionClick={ onSuggestionClick }\n\t\t\t\t\tgetRefData={ () => this.getRefData() }\n\t\t\t\t/>\n\t\t\t</div>\n\t\t)\n\t}\n}\n\nSearch.propTypes = {\n\tstoreWeapon: PropTypes.func.isRequired,\n\tstoreRarity: PropTypes.func.isRequired,\n\tstoreWeaponType: PropTypes.func.isRequired,\n\tstoreDamage: PropTypes.func.isRequired,\n};\n\nconst mapStateToProps = state => ({\n\tmanifest: state.manifest,\n\tmanifestLoaded: state.manifestLoaded,\n\tfilters: state.filters,\n\tweapon: state.weapon,\n});\n\nexport default connect(mapStateToProps, { \n\tstoreWeapon,\n\tstoreRarity, storeWeaponType, storeDamage,\n})(Search);"]},"metadata":{},"sourceType":"module"}